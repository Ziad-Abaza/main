import{b as w,u as k,J as Q,K as C,m as _,I as V,p as t,o as s,q as o,v as r,A as f,B as b,s as B,D as y,L as h,C as E}from"./app-CwzL3_Sr.js";const S={class:"max-w-2xl mx-auto py-8"},I={key:0,class:"text-gray-400"},U={key:1,class:"text-red-500"},A={key:2},D={class:"text-xl font-semibold mb-4"},F={class:"font-semibold mb-2 text-lg"},L={key:0},M={class:"flex items-center gap-2 cursor-pointer"},N=["name","value","onUpdate:modelValue"],R={key:1},J={class:"flex items-center gap-2 cursor-pointer"},K=["name","value","onUpdate:modelValue"],P={key:3,class:"text-gray-400"},j={__name:"CourseQuiz",setup(G){const x=k(),z=Q(),m=x.params.id,c=C(),v=_(!0),l=_(null),i=_(null),n=_({});V(async()=>{v.value=!0,l.value=null;try{if(i.value=await c.fetchQuizById(m),!i.value)throw new Error("Quiz not found");i.value.questions&&(i.value.questions.forEach(u=>{n.value[u.question_id]=null}),console.log("Quiz questions:",i.value.questions),console.log("Answers initialized:",n.value))}catch(u){console.error("Error loading quiz:",u),l.value=c.error||"Failed to load quiz."}finally{v.value=!1}});async function q(){try{const u=i.value.questions.map(e=>({question_id:e.question_id,selected_option_id:n.value[e.question_id],type:e.type||"mcq"}));if(u.find(e=>!e.selected_option_id)){l.value="Please answer all questions before submitting.";return}await c.submitAnswers(m,u),z.push({name:"profile-quiz-result",params:{id:m}})}catch(u){console.error("Error submitting quiz:",u),l.value=c.error||"Failed to submit quiz."}}return(u,d)=>(s(),t("div",S,[d[1]||(d[1]=o("h1",{class:"text-3xl font-bold mb-6"},"Course Quiz",-1)),v.value?(s(),t("div",I,"Loading quiz...")):l.value?(s(),t("div",U,r(l.value),1)):i.value?(s(),t("div",A,[o("h2",D,r(i.value.title),1),o("form",{onSubmit:E(q,["prevent"])},[(s(!0),t(f,null,b(i.value.questions,(e,g)=>(s(),t("div",{key:e.question_id,class:"mb-8"},[o("div",F,r(g+1)+". "+r(e.text),1),e?(s(),t("div",L,[(s(!0),t(f,null,b(e.options,a=>(s(),t("div",{key:a.option_id,class:"mb-2"},[o("label",M,[y(o("input",{type:"radio",name:e.question_id,value:a.option_id,"onUpdate:modelValue":p=>n.value[e.question_id]=p,class:"form-radio"},null,8,N),[[h,n.value[e.question_id]]]),o("span",null,r(a.option_text),1)])]))),128))])):e.type==="true_false"?(s(),t("div",R,[(s(!0),t(f,null,b(e.options,a=>(s(),t("div",{key:a.option_id,class:"mb-2"},[o("label",J,[y(o("input",{type:"radio",name:e.question_id,value:a.option_id,"onUpdate:modelValue":p=>n.value[e.question_id]=p,class:"form-radio"},null,8,K),[[h,n.value[e.question_id]]]),o("span",null,r(a.option_text),1)])]))),128))])):B("",!0)]))),128)),d[0]||(d[0]=o("button",{type:"submit",class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 mt-4"},"Submit Quiz",-1))],32)])):(s(),t("div",P,"No quiz found for this course."))]))}},O=w(j,[["__scopeId","data-v-9f0b4324"]]);export{O as default};
